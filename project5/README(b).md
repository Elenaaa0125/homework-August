# 椭圆曲线数字签名算法安全性实验报告

## 实验目的
1. 演示ECDSA签名算法中临时密钥k泄露的安全风险
2. 分析k值重用在不同场景下的安全隐患
3. 验证混合使用不同签名算法可能导致的安全漏洞
4. 理解数字签名实现中的最佳安全实践

## 实验环境
| 环境组件       | 版本/配置          |
|----------------|--------------------|
| Python         | 3.8+               |
| 操作系统       | 任意支持Python的系统 |
| 依赖库         | hashlib, math      |
| 曲线参数       | a=5, b=7, p=9       |
| 基点G          | (5, 1)             |
| 基点阶数n      | 11                 |

## 实验原理

### 1. ECDSA签名算法
给定椭圆曲线参数(a,b,p,G,n)，私钥d和消息m，签名过程为：

1. 计算消息哈希：$e = H(m)$
2. 生成随机数：$k \in [1,n-1]$
3. 计算曲线点：$R = kG = (x,y)$
4. 计算：$r = x \mod n$
5. 计算：$s = k^{-1}(e + dr) \mod n$
6. 输出签名：$(r, s)$

### 2. 安全隐患数学原理

**k泄露情况：**
$$ d = \frac{ks - e}{r} \mod n $$

**k重用情况（两个消息m₁,m₂）：**
$$ k = \frac{e₁ - e₂}{s₁ - s₂} \mod n $$
$$ d = \frac{ks₁ - e₁}{r} \mod n $$

**混合签名攻击：**
结合ECDSA签名$(r,s)$和Schnorr签名$(R,s',e')$：
$$ d = \frac{s's - e}{r + e's} \mod n $$

## 实验内容与结果

### 场景1：临时密钥k泄露导致私钥泄露

**实验代码：**
```python
demo.demonstrate_k_leakage()
```

**输出结果：**

真实私钥 d = 3

恢复的私钥 d' = 3

验证结果: 成功

### 场景2：临时密钥k重用导致私钥泄露

**实验代码：**
```python
demo.demonstrate_k_reuse()
```

**输出结果：**

真实私钥 d = 3

恢复的临时密钥 k' = 2

恢复的私钥 d' = 3

验证结果: 成功

### 场景3：多用户使用相同k导致私钥泄露

**实验代码：**
```python
demo.demonstrate_shared_k()
```

**输出结果：**

真实私钥 d1 = 3, d2 = 5

恢复的私钥 d1' = 3, d2' = 5

验证结果: 成功

### 场景4：混合签名算法导致私钥泄露

**实验代码：**
```python
demo.demonstrate_mixed_signatures()
```

**输出结果：**

真实私钥 d = 3

恢复的私钥 d' = 3

验证结果: 成功

